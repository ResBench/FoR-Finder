<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FoR Finder by ResBench</title>
    <link href="https://fonts.googleapis.com/css2?family=Jersey+10+Charted&family=Jersey+10&family=Montserrat:wght@700&display=swap" rel="stylesheet">
    <link rel="icon" href="Logo 1.png" type="image/png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.11.1/core.css">
    <script type="module" src="https://pyscript.net/releases/2024.11.1/core.js"></script>
    <style>
        html {
            font-size: 14px;
        }
        body {
            font-family: 'Helvetica', Arial, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        h3 {
            font-family: 'Jersey 10', sans-serif;
            cursor: pointer;
            font-size: 1.6rem; /* Equivalent to 24px */
            font-weight: normal;
        }
        h3.open {
            font-size: 1.6rem; /* Equivalent to 24px */
        }
        h4 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.2rem; /* Equivalent to 20px */
        }
        *, *::before, *::after {
            box-sizing: inherit; /* Ensure consistent box-sizing */
        }
        .banner-container {
            position: relative;
            width: 100%;
            max-width: 100%;
        }
        .banner {
            width: 100%;
            max-width: 100%;
            height: 200px;
            object-fit: cover;
            object-position: center;
            display: block;
        }
        .banner-title {
            display: block;
            position: absolute;
            color: white;
            margin: 0;
            padding-left: 20px;
        }
        .banner-title.h1 {
            top: 40px;
            left: 20px;
            font-family: 'Jersey 10', sans-serif;
            font-weight: normal;
            font-size: 3rem;
            max-width: 80vw; /* 80% of the viewport width */
        }
        .banner-title.h2 {
            top: 160px;
            left: 20px;
            font-family: 'Jersey 10 Charted', sans-serif;
            font-weight: normal;
            font-size: 1.6rem;   /* Equivalent to 32px */
        }
        .banner-title.h2 .h1-style {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            font-size: 1.2rem;
        }
        .container {
            margin: 20px;
        }

        .content {
            display: none;
            max-width: 100%; /* Ensure content doesn't exceed its container */
            overflow-x: auto; /* Prevent horizontal scrolling if content overflows */
        }
        .content p, .content ol {
            word-wrap: break-word;
            overflow-wrap: anywhere;
            font-size: 1rem;   /* Equivalent to 16px */
        }        
        
        .arrow {
            display: inline-block;
            margin-right: 8px;
            transition: transform 0.2s ease;
        }
        
        h3.open .arrow {
            transform: rotate(90deg);
        }
        .warning-message {
            background-color: darkorange;
            color: white;
            padding: 10px;
            margin-top: 10px;
            display: none; /* Initially hidden */
        }
        .floating-logo {
            position: fixed;
            top: 15px;
            right: 30px;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: transform 0.3s ease, opacity 0.3s ease;
            opacity: 0.5; /* Slightly translucent */
        }
        
        .floating-logo:hover {
            transform: scale(1.2);
            opacity: 0.8; /* Fully opaque on hover */
        }
        .floating-logo-coffee {
            position: fixed;
            top: 115px;
            right: 30px;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: transform 0.3s ease, opacity 0.3s ease;
            opacity: 0.5; /* Slightly translucent */
        }
        
        .floating-logo-coffee:hover {
            transform: scale(1.2);
            opacity: 0.8; /* Fully opaque on hover */
        }
        @media (max-width: 600px) {
            .banner-title.h1 {
                font-size: 1.8rem; /* Reduce h1 size on mobile devices */
            }
            .banner-title.h2 {
                font-size: 1.5rem; /* Adjust h2 size for mobile if necessary */
            }
            .banner-title.h2 .h1-style {
                font-family: 'Montserrat', sans-serif;
                font-weight: 700;
                font-size: 1.2rem;
            }
            h3 {
                font-size: 1.2rem; /* Adjust h3 size for mobile */
            }
            h3.open {
                font-size: 1.2rem; /* Adjust h3 size for mobile */
            }
            h4 {
                font-size: 1rem; /* Adjust h4 size for mobile */
            }
        }
    </style>
</head>
<body>
  <div class="banner-container">
    <img src="Banner 2.png" alt="Banner Image" class="banner">
    <h1 class="banner-title h1">FoR Finder</h1>
    <h2 class="banner-title h2"><span class="h1-style">Created by&nbsp;</span>&nbsp;ResBench&nbsp;</h2>
  </div>

  <div class="container">
    <h3 onclick="toggleContent(this)"><span class="arrow">&#9654;</span> Purpose</h3>
    <div class="content">
      <p>This app makes the Australian and New Zealand Standard Research Classification (ANZSRC) Fields of Research (FoR) easier to use than the raw Australian Bureau of Statistics spreadsheet, allowing users to quickly search by keywords, and see current 2020 and retired 2008 codes side by side.</p>
    </div>

    <h3 onclick="toggleContent(this)"><span class="arrow">&#9654;</span> Background</h3>
    <div class="content" style="display: none;">
      <p>ANZSRC Fields of Research FoR 2020 Field codes allow for research activity to be categorised according to common knowledge domains and/or methodologies. FoR is a hierarchical classification and includes three levels: two-digit Divisions (at the broadest level), four-digit Groups, and six-digit Fields (at the finest level), with Fields codes frequently requested in research management systems and grant applications.</p>
    </div>

    <h3 onclick="toggleContent(this)"><span class="arrow">&#9654;</span> Sources</h3>
    <div class="content" style="display: none;">
      <ol>
        <li>Australian Bureau of Statistics. (n.d.). 
          <i>Australian and New Zealand Standard Research Classification (ANZSRC): Latest release</i>. 
          Australian Government. Retrieved September 11, 2024, from 
          <a href="https://www.abs.gov.au/statistics/classifications/australian-and-new-zealand-standard-research-classification-anzsrc/latest-release" target="_blank">
            https://www.abs.gov.au/statistics/classifications/australian-and-new-zealand-standard-research-classification-anzsrc/latest-release
          </a>.
        </li>
      </ol>
    </div>
  </div>

  <div class="container">
    <div class="row">
      <input 
        type="text" 
        id="nameFilter" 
        placeholder="Filter by keyword(s) (separated by a single space)" 
      >
    </div>

    <div class="row">
      <table id="resultsTable" border="1" style="width:100%; border-collapse: collapse;">
        <thead>
          <tr>
            <th>2020 Code</th>
            <th>2020 Name</th>
            <th class="greyed">2008 Code</th>
            <th class="greyed">2008 Name</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- PapaParse CSV parser -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

    <style>
      table {
          width: 100%;
          border-collapse: collapse;
          table-layout: fixed; /* Fix column widths */
          margin-top: 10px;
      }
    
      th, td {
          border: 1px solid black;
          padding: 8px;
          text-align: left;
          word-wrap: break-word; /* Wrap long text */
      }
    
      th {
          background-color: #808080;
          font-weight: bold;
          color: white;
      }
    
      tr:hover {
          background-color: #f1f1f1;
      }
    
        /* Greyed 2008 columns for data cells only, skip header */
        td.greyed {
            color: #555;
            background-color: #e8e8e8;
        }

    
      /* Set fixed widths for columns */
      th:nth-child(1), td:nth-child(1) { width: 15%; }  /* 2020 Code */
      th:nth-child(2), td:nth-child(2) { width: 35%; }  /* 2020 Name */
      th:nth-child(3), td:nth-child(3) { width: 15%; }  /* 2008 Code */
      th:nth-child(4), td:nth-child(4) { width: 35%; }  /* 2008 Name */
    
        input#nameFilter {
            margin: 0 0;
            padding: 6px;
            width: 100%;              /* full width of the container */
            border: 1px solid #000;   /* normal state: single 1px black border */
            box-sizing: border-box;   /* ensures padding is included in width */
            font-size: 14px;
        }
        
        /* Focus/selected state */
        input#nameFilter:focus {
            border: 3px double #000;  /* double black border */
            border-radius: 0;          /* no rounding */
            outline: none;             /* remove default browser outline */
            box-sizing: border-box;   /* keeps total size the same */

        }

    </style>


  <script type="text/javascript">
    function toggleContent(header) {
      var content = header.nextElementSibling;
      var arrow = header.querySelector('.arrow');
      if (content.style.display === "none" || content.style.display === "") {
        content.style.display = "block";
      } else {
        content.style.display = "none";
      }
      header.classList.toggle('open');
    }

    let allRecords = [];

    // Fetch the 2020 concordance CSV
    async function fetchCSV() {
      const response = await fetch('Correspondences2020.csv');
      return await response.text();
    }

    // Clean text: remove surrounding quotes and trim spaces
    function cleanText(text) {
      return (text || '').replace(/^"|"$/g, '').trim();
    }

    // Load CSV data into memory
    async function loadConcordances(csvData) {
      const results = Papa.parse(csvData, { header: true, skipEmptyLines: true });
      allRecords = results.data.map(row => {
        let pastCode = row['ANZSRC 2008 Code'];
        if (pastCode && pastCode.length === 5) pastCode = '0' + pastCode;
        const currentCode = row['ANZSRC 2020 Code'];
        return {
          'ANZSRC 2020 FoR Field Code': currentCode,
          'ANZSRC 2020 FoR Field Code Name': cleanText(row['ANZSRC 2020 Name']),
          'ANZSRC 2008 FoR Field Code': pastCode,
          'ANZSRC 2008 FoR Field Code Name': cleanText(row['ANZSRC 2008 Name'])
        };
      });
      // Do NOT display immediately — only header should show initially
      displayTable([]);
    }

    // Display rows in table
    function displayTable(records) {
      const table = document.querySelector('#resultsTable');
      const tbody = table.querySelector('tbody');
      tbody.innerHTML = '';

      records.forEach(rec => {
        const row = tbody.insertRow();
        row.innerHTML = `
          <td>${rec['ANZSRC 2020 FoR Field Code']}</td>
          <td>${rec['ANZSRC 2020 FoR Field Code Name']}</td>
          <td class="greyed">${rec['ANZSRC 2008 FoR Field Code'] || ''}</td>
          <td class="greyed">${rec['ANZSRC 2008 FoR Field Code Name'] || ''}</td>
        `;
      });
    }

    // Filter by multiple keywords (AND logic)
    function filterByName(query) {
      const words = query.toLowerCase().split(/\s+/).filter(Boolean);

      if (words.length === 0) {
        displayTable([]); // Empty → hide rows
        return;
      }

      const filtered = allRecords.filter(rec => {
        const fieldName = rec['ANZSRC 2020 FoR Field Code Name'].toLowerCase();
        // Each word must appear somewhere in the name
        return words.every(w => fieldName.includes(w));
      });

      displayTable(filtered);
    }

    // Initialize
    document.addEventListener("DOMContentLoaded", async () => {
      const csvData = await fetchCSV();
      await loadConcordances(csvData);

      const nameFilterInput = document.getElementById('nameFilter');
      nameFilterInput.addEventListener('input', (e) => {
        filterByName(e.target.value);
      });
    });
  </script>


<a href="https://bsky.app/profile/resbench.bsky.social" target="_blank">
    <img src="Logo 1.png" alt="Logo" class="floating-logo">
</a>

<a href="https://buymeacoffee.com/resbench" target="_blank">
    <img src="bmc-logo-yellow.png" alt="Logo" class="floating-logo-coffee">
</a>

</body>
</html>
